<!doctype html><html lang=en prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=https://young-mann.top//apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://young-mann.top//favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://young-mann.top//favicon-16x16.png><link rel=manifest href=https://young-mann.top//site.webmanifest><link rel=mask-icon href=https://young-mann.top//safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta name=keywords content="概率论,
"><meta property="og:title" content="小记概率论里的一些题"><meta property="og:description" content="假设一对夫妻打算生孩子。他们采取的剩余策略是，除非连续生出3个女孩，否则一直生新的小孩。那么，现在的问题是，当这对夫妻停止生育时，他们已生下的小孩有多少个？ 为了回答这个问题，可以直接考虑不同小孩数量的概率。假设每次生育时，生出女孩的概率为$p$，生出男孩的概率为$q :=1-p$。那么，在这题里：
样本空间中的样本点 $\omega_i$ 是长度为 i 的已被生下来的小孩的性别序列。例如，$w_2 = BG$ 表示一共生了两个小孩，第一个是男孩，第二个是女孩； 我们设定一个随机变量 $\text{X}(\omega): \Omega \rightarrow \mathbb R$ 。这个随机变量需要输入一个样本点，即上文提到的性别序列，并输出所输入序列的长度值； 概率测度 $\text P(x) = \text P(\text{X}=x)$表示「这对夫妻停止生育时，他们已生下的小孩有 x 个」的概率。 不难求出以下递归形式， $$ \begin{align} \text P(1)&=0 \\ \text P(2)&=0 \\ \text P(3)&=p^3 \\ \text P(4)&=qp^3=q\text P(3) \\ \text P(5)&=q^2\text P(3)+qp\text P(3)=q\text P(4)+qp\text P(3) \\ \text P(6)&=q\text P(5)+qp\text P(4)+qp^2\text P(3) \\ \cdots \\ \text P(n)&=q\text P(n-1)+qp\text P(n-2)+qp^2\text P(n-3) \end{align} $$
取$p=0.5$，可得：
p=0.5; q=1-p; f=zeros(60,1); f(3)=p^3; for i=4:60 f(i)=q*f(i-1)+q*p*f(i-2)+q*p^2*f(i-3); end bar(f) Mathematical Statistics and Data Analysis (3rd Edition) (C1-11) Consider the binomial distribution with $n$ trials and probability $p$ of success on each trial."><meta property="og:type" content="article"><meta property="og:url" content="https://young-mann.top/posts/%E5%B0%8F%E8%AE%B0%E6%A6%82%E7%8E%87%E8%AE%BA%E9%87%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-26T20:09:07+02:00"><meta property="article:modified_time" content="2023-09-26T20:09:07+02:00"><meta property="og:site_name" content="狗蛋日"><meta name=twitter:card content="summary"><meta name=twitter:title content="小记概率论里的一些题"><meta name=twitter:description content="假设一对夫妻打算生孩子。他们采取的剩余策略是，除非连续生出3个女孩，否则一直生新的小孩。那么，现在的问题是，当这对夫妻停止生育时，他们已生下的小孩有多少个？ 为了回答这个问题，可以直接考虑不同小孩数量的概率。假设每次生育时，生出女孩的概率为$p$，生出男孩的概率为$q :=1-p$。那么，在这题里：
样本空间中的样本点 $\omega_i$ 是长度为 i 的已被生下来的小孩的性别序列。例如，$w_2 = BG$ 表示一共生了两个小孩，第一个是男孩，第二个是女孩； 我们设定一个随机变量 $\text{X}(\omega): \Omega \rightarrow \mathbb R$ 。这个随机变量需要输入一个样本点，即上文提到的性别序列，并输出所输入序列的长度值； 概率测度 $\text P(x) = \text P(\text{X}=x)$表示「这对夫妻停止生育时，他们已生下的小孩有 x 个」的概率。 不难求出以下递归形式， $$ \begin{align} \text P(1)&=0 \\ \text P(2)&=0 \\ \text P(3)&=p^3 \\ \text P(4)&=qp^3=q\text P(3) \\ \text P(5)&=q^2\text P(3)+qp\text P(3)=q\text P(4)+qp\text P(3) \\ \text P(6)&=q\text P(5)+qp\text P(4)+qp^2\text P(3) \\ \cdots \\ \text P(n)&=q\text P(n-1)+qp\text P(n-2)+qp^2\text P(n-3) \end{align} $$
取$p=0.5$，可得：
p=0.5; q=1-p; f=zeros(60,1); f(3)=p^3; for i=4:60 f(i)=q*f(i-1)+q*p*f(i-2)+q*p^2*f(i-3); end bar(f) Mathematical Statistics and Data Analysis (3rd Edition) (C1-11) Consider the binomial distribution with $n$ trials and probability $p$ of success on each trial."><meta itemprop=name content="小记概率论里的一些题"><meta itemprop=description content="假设一对夫妻打算生孩子。他们采取的剩余策略是，除非连续生出3个女孩，否则一直生新的小孩。那么，现在的问题是，当这对夫妻停止生育时，他们已生下的小孩有多少个？ 为了回答这个问题，可以直接考虑不同小孩数量的概率。假设每次生育时，生出女孩的概率为$p$，生出男孩的概率为$q :=1-p$。那么，在这题里：
样本空间中的样本点 $\omega_i$ 是长度为 i 的已被生下来的小孩的性别序列。例如，$w_2 = BG$ 表示一共生了两个小孩，第一个是男孩，第二个是女孩； 我们设定一个随机变量 $\text{X}(\omega): \Omega \rightarrow \mathbb R$ 。这个随机变量需要输入一个样本点，即上文提到的性别序列，并输出所输入序列的长度值； 概率测度 $\text P(x) = \text P(\text{X}=x)$表示「这对夫妻停止生育时，他们已生下的小孩有 x 个」的概率。 不难求出以下递归形式， $$ \begin{align} \text P(1)&=0 \\ \text P(2)&=0 \\ \text P(3)&=p^3 \\ \text P(4)&=qp^3=q\text P(3) \\ \text P(5)&=q^2\text P(3)+qp\text P(3)=q\text P(4)+qp\text P(3) \\ \text P(6)&=q\text P(5)+qp\text P(4)+qp^2\text P(3) \\ \cdots \\ \text P(n)&=q\text P(n-1)+qp\text P(n-2)+qp^2\text P(n-3) \end{align} $$
取$p=0.5$，可得：
p=0.5; q=1-p; f=zeros(60,1); f(3)=p^3; for i=4:60 f(i)=q*f(i-1)+q*p*f(i-2)+q*p^2*f(i-3); end bar(f) Mathematical Statistics and Data Analysis (3rd Edition) (C1-11) Consider the binomial distribution with $n$ trials and probability $p$ of success on each trial."><meta itemprop=datePublished content="2023-09-26T20:09:07+02:00"><meta itemprop=dateModified content="2023-09-26T20:09:07+02:00"><meta itemprop=wordCount content="600"><meta itemprop=keywords content="概率论,"><title>小记概率论里的一些题 || 狗蛋日</title><link rel=canonical href=https://young-mann.top/posts/%E5%B0%8F%E8%AE%B0%E6%A6%82%E7%8E%87%E8%AE%BA%E9%87%8C%E7%9A%84%E4%B8%80%E4%BA%9B%E9%A2%98/><link rel=stylesheet href=/css/reboot.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/syntax.css><script type=text/javascript src=/js/main.js></script>
<link href="https://fonts.googleapis.com/css?family=Lora&display=swap" rel=stylesheet><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC&family=Noto+Serif+SC&display=swap" rel=stylesheet><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body class=look-sheet-bkg lang=en><div class="navbar nav-bkg drop-shadow"><nav class="content-container pagewide-bar-padding"><span class=divider>/</span>
<a href=/>狗蛋日</a>
<span class=divider>/</span>
<a href=/posts/>Posts</a><ul class="list-unstyled right-links"><li><a href=/posts/about/><span class=post-title>关于</span></a></li></ul></nav></div><article id=main class="content-container look-sheet article-pad-v" itemscope itemtype=https://schema.org/Article><meta itemprop=author content><meta itemprop=publisher content><meta itemprop=image content><h1 itemprop=name id=title>小记概率论里的一些题</h1><meta itemprop=headline content="小记概率论里的一些题"><div class=post-tags><a href=https://young-mann.top/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/>#概率论</a>&nbsp;</div><div class=post-date><span itemprop=datePublished>September 26, 2023</span></div><meta itemprop=dateModified content="September 26, 2023"><div itemprop=articleBody id=content class="article-body margin-top-2em"><details><summary><strong>目录 / Table of Contents</strong></summary><div class=col-md-2><div id=page-scrollspy class=toc-nav><nav id=TableOfContents><ul><li><a href=#mathematical-statistics-and-data-analysis-3rd-edition>Mathematical Statistics and Data Analysis (3rd Edition)</a></li></ul></nav></div></div></details><details><summary>假设一对夫妻打算生孩子。他们采取的剩余策略是，除非连续生出3个女孩，否则一直生新的小孩。那么，现在的问题是，当这对夫妻停止生育时，他们已生下的小孩有多少个？</summary><p>为了回答这个问题，可以直接考虑不同小孩数量的概率。假设每次生育时，生出女孩的概率为$p$，生出男孩的概率为$q :=1-p$。那么，在这题里：</p><ul><li>样本空间中的样本点 $\omega_i$ 是长度为 i 的已被生下来的小孩的性别序列。例如，$w_2 = BG$ 表示一共生了两个小孩，第一个是男孩，第二个是女孩；</li><li>我们设定一个随机变量 $\text{X}(\omega): \Omega \rightarrow \mathbb R$ 。这个随机变量需要输入一个样本点，即上文提到的性别序列，并输出所输入序列的长度值；</li><li>概率测度 $\text P(x) = \text P(\text{X}=x)$表示「这对夫妻停止生育时，他们已生下的小孩有 x 个」的概率。</li></ul><p>不难求出以下递归形式，
$$
\begin{align}
\text P(1)&=0
\\
\text P(2)&=0
\\
\text P(3)&=p^3
\\
\text P(4)&=qp^3=q\text P(3)
\\
\text P(5)&=q^2\text P(3)+qp\text P(3)=q\text P(4)+qp\text P(3)
\\
\text P(6)&=q\text P(5)+qp\text P(4)+qp^2\text P(3)
\\
\cdots
\\
\text P(n)&=q\text P(n-1)+qp\text P(n-2)+qp^2\text P(n-3)
\end{align}
$$</p><p>取$p=0.5$，可得：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-matlab data-lang=matlab><span style=display:flex><span>p=<span style=color:#ae81ff>0.5</span>; 
</span></span><span style=display:flex><span>q=<span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>p; 
</span></span><span style=display:flex><span>f=zeros(<span style=color:#ae81ff>60</span>,<span style=color:#ae81ff>1</span>); 
</span></span><span style=display:flex><span>f(<span style=color:#ae81ff>3</span>)=p^<span style=color:#ae81ff>3</span>; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i=<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>60</span> 
</span></span><span style=display:flex><span>    f(i)=q<span style=color:#f92672>*</span>f(i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>+</span>q<span style=color:#f92672>*</span>p<span style=color:#f92672>*</span>f(i<span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>+</span>q<span style=color:#f92672>*</span>p^<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>f(i<span style=color:#f92672>-</span><span style=color:#ae81ff>3</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span> 
</span></span><span style=display:flex><span>bar(f)
</span></span></code></pre></div></details><h2 id=mathematical-statistics-and-data-analysis-3rd-edition>Mathematical Statistics and Data Analysis (3rd Edition)</h2><details><summary>(C1-11) Consider the binomial distribution with $n$ trials and probability $p$ of success on each trial. For what value of $k$ is $P(X=k)$ maximized? This value is called the mode of the distribution. (Hint: Consider the ratio of successive terms.)</summary>
$$
\begin{aligned} \frac{P(X=k+1)}{P(X=k)}
& =\frac{C^{k+1}_n p^{k+1}(1-p)^{n-k-1}}{C^{k}_n p^k(1-p)^{n-k}}\\\
&=\frac{p}{1-p} \cdot \frac{n-k}{k+1} .\end{aligned}
$$<p>随着k取值的增加，以上表达式中的比值会经历大于1（可能还会等于1）以及小于1的变化。我们希望找到能让上式小于1（即$\frac{p}{1-p} \cdot \frac{n-k}{k+1}&lt;1$）的最小的k。易得：
$$
n p-k p&lt;k-k p+1-p \Longleftrightarrow k>p \cdot(n+1)-1
$$</p><p>最后可得$k =\lfloor p \cdot(n+1)\rfloor$。</p></details><hr><details><summary>(C2-70) Let $U$ be a uniform random variable. Find the density function of $V=U^{-\alpha}, \alpha>0$. Compare the rates of decrease of the tails of the densities as a function of $\alpha$. Does the comparison make sense intuitively?</summary>
$$
f_V(x)=F_V^{\prime}(x)=\left(1-x^{-\frac{1}{\alpha}}\right)^{\prime}=-\left(-\frac{1}{\alpha}\right) \cdot x^{-\frac{1}{\alpha}-1}=\frac{1}{\alpha} \cdot x^{-\left(1+\frac{1}{\alpha}\right)}, \quad x \in[1,+\infty\rangle .
$$</details><hr><details><summary>(C2-71) This problem shows one way to generate discrete random variables from a uniform random number generator. Suppose that $F$ is the cdf of an integer-valued random variable; let $\text{U}$ be uniform on $[0,1]$. Define a random variable $Y=k$, if $F(k-1)<\text{U}\leq F(k)$. Show that $Y$ has cdf $F$. Apply this result to show how to generate geometric random variables from uniform random variables.</summary><p>这题一共两问。第一问要求证明题中构造的随机变量$Y$的分布函数与目标分布的函数相等，即$F_Y=F_{服从目标分布的随机变量}$。第二问要求用第一问的结论，构造一个服从几何分布的随机变量。第一小问只需直接计算$Y$的分布函数即可得证。这里只做第二小问。</p><figure class=bigger><img src=https://s2.loli.net/2023/09/28/7I6OoC89hrTUAQW.jpg></figure></details><p>注：这题给出了一种基于 服从均匀分布的随机变量 生成 服从指定分布的随机变量 的方法，可与讲义上的 Proposition 相照应。</p><blockquote><p><strong>Proposition C</strong></p><p>Let $X$ be a continuous random variable and define $Z:=F(X)$, where $F$ is the c.d.f. of $X$ and assumed to be invertible on supp $(X)$. Then $Z \sim U[0,1]$.
<strong>Proof</strong>
$$
P(Z \leq z)=P(F(X) \leq z)=P\left(X \leq F^{-1}(z)\right)=F\left(F^{-1}(z)\right)=z
$$
<strong>Proposition D</strong></p><p>Assume $U \sim U[0,1]$ and let $X:=F^{-1}(U)$, where $F$ is an arbitrary function that satisfies all the properties of a c.d.f. and in addition is assumed to be invertible.
Then the c.d.f. of $X$ is $F$.
Proof
$$
P(X \leq x)=P\left(F^{-1}(U) \leq x\right)=P(U \leq F(x))=F(x)
$$</p></blockquote><hr><details><summary>(C3-8) 下面这两题的题目详情不重要了，主要是我积分积错了，记在这里提醒一下自己。</summary>
$$
\begin{aligned}
P(X+Y \leq 1)= & P(X \leq 1-Y)=\int_0^1 \int_0^{1-y} \frac{6}{7}(x+y)^2 d x d y \\
= & \left.\int_0^1\left(\frac{2}{7}(x+y)^3\right)\right|_0 ^{1-y} d y \\
& =\int_0^1-\frac{2}{7} y^3+\frac{2}{7} d y \\
& =\left.\left(-\frac{1}{14} y^4+\frac{2}{7} y\right)\right|_0 ^1 \\
& =\frac{3}{14} \approx 0.2143
\end{aligned}
$$</details><hr><details><summary>(C3-11) Let $U_1, U_2$, and $U_3$ be independent random variables uniform on $[0,1]$. Find the probability that the roots of the quadratic $U_1 x^2+U_2 x+U_3$ are real.</summary><ol><li><p>计算 $X=U_1U_3$ 的分布函数
$$
\begin{aligned}
F_{U_1 \cdot U_3}(x) & =P\left(U_1 \cdot U_3 \leq x\right)=\iint_{u_1 \cdot u_3 \leq x} f_{U_1, U_3}\left(u_1, u_3\right) d u_1 d u_3 \\
& =\iint_{u_1 \cdot u_3 \leq x} f_{U_1}\left(u_1\right) \cdot f_{U_3}\left(u_3\right) d u_1 d u_3 \\
& =\int_0^x \int_0^1 d u_3 d u_1+\int_x^1 \int_0^{\frac{x}{u_1}} d u_3 d u_1=\int_0^x d u_1+\int_x^1 \frac{x}{u_1} d u_1 \\
& =x+\left.x \cdot \ln u_1\right|_x ^1=x+x \cdot(0-\ln x) \\
& =x-x \ln x .
\end{aligned}
$$</p></li><li><p>使用上一部分求出的分布函数求解 $P[U_1U_3 \leq \frac {U^2_2}{4} ]$
$$
\begin{aligned}
P\left(X \leq \frac{U_2^2}{4}\right) & =\iint_{x \leq \frac{u_2^2}{4}} f_{X, U_2}\left(x, u_2\right) d x d u_2=\iint_{x \leq \frac{u_2^2}{4}} f_X(x) \cdot f_{U_2}\left(u_2\right) d x d u_2 \\
& =\int_0^1\left(\int_0^{\frac{u_2^2}{4}}-\ln x \cdot 1 d x\right) d u_2=\int_0^1-\left.(x \cdot(\ln x-1))\right|_0 ^{\frac{u_2^2}{4}} d u_2 \\
& =\int_0^1 \frac{u_2^2}{4} \cdot\left(1-\ln \left(\frac{u_2^2}{4}\right)\right) d u_2=\left|\begin{array}{ll}
u=\ln \left(\frac{u_2^2}{4}\right) & d v=\frac{u_2^2}{4} d u_2 \\
d u=\frac{2}{u_2} d u_2 & v=\frac{u_2^3}{12}
\end{array}\right| \\
& =\left.\frac{u_2^3}{12}\right|_0 ^1-\left.\frac{u_2^3}{12} \cdot \ln \left(\frac{u_2^2}{4}\right)\right|_0 ^1+\int_0^1 \frac{u_2^2}{6} d u_2=\frac{1}{12}-\frac{1}{12} \cdot \ln \left(\frac{1}{4}\right)+\left.\frac{u_2^3}{18}\right|_0 ^1 \\
& =\frac{1}{12}+\frac{1}{12} \cdot \ln 4+\frac{1}{18} \\
& =\frac{5+3 \cdot \ln 4}{36} .
\end{aligned}
$$</p></li></ol></details></div></article><div class="nav-bkg-50 content-container-narrow-pad bottom-links text-0p75 drop-shadow"><nav class=flex-row><a href=https://young-mann.top/posts/%E4%BA%8C%E5%8D%81%E4%BA%8C%E5%B2%81%E5%87%BA%E9%97%A8%E8%BF%9C%E8%A1%8C/ class="flex-row v-center no-underline" style=max-width:45%><span class=text-1p5>←</span>&nbsp;<span class=re-underline>Previous: 二十二岁出门远行</span></a>
<a href=https://young-mann.top/posts/%E8%8D%89%E7%A8%BF/ class="flex-row v-center no-underline" style=max-width:45%><span class=re-underline>Next: 草稿纸</span>&nbsp;<span class=text-1p5>→</span></a></nav></div></body></html>